{
  "entities": {
    "District": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "District",
      "type": "object",
      "description": "Represents a police district.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the District entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the district."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "Record": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Record",
      "type": "object",
      "description": "Represents a single police record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Record entity."
        },
        "districtId": {
          "type": "string",
          "description": "Reference to District. (Relationship: District 1:N Record)"
        },
        "category": {
          "type": "string",
          "description": "Category of the record (e.g., NBW, Conviction, Narcotics)."
        },
        "value": {
          "type": "number",
          "description": "The numerical value of the record."
        },
        "date": {
          "type": "string",
          "description": "Date of the record.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "districtId",
        "category",
        "value",
        "date"
      ]
    },
    "SpecialDrive": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SpecialDrive",
      "type": "object",
      "description": "Represents a special drive conducted by the police.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the SpecialDrive entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the special drive."
        },
        "startDate": {
          "type": "string",
          "description": "Start date of the special drive.",
          "format": "date-time"
        },
        "endDate": {
          "type": "string",
          "description": "End date of the special drive.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "Description of the special drive."
        }
      },
      "required": [
        "id",
        "name",
        "startDate",
        "endDate",
        "description"
      ]
    },
    "Conviction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Conviction",
      "type": "object",
      "description": "Represents a conviction record.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Conviction entity."
        },
        "districtId": {
          "type": "string",
          "description": "Reference to District. (Relationship: District 1:N Conviction)"
        },
        "caseNumber": {
          "type": "string",
          "description": "Case number for the conviction."
        },
        "date": {
          "type": "string",
          "description": "Date of the conviction.",
          "format": "date-time"
        },
        "offense": {
          "type": "string",
          "description": "Description of the offense."
        }
      },
      "required": [
        "id",
        "districtId",
        "caseNumber",
        "date",
        "offense"
      ]
    },
    "Detection": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Detection",
      "type": "object",
      "description": "Represents a detection record (e.g., crime detection).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Detection entity."
        },
        "districtId": {
          "type": "string",
          "description": "Reference to District. (Relationship: District 1:N Detection)"
        },
        "crimeType": {
          "type": "string",
          "description": "Type of crime detected."
        },
        "date": {
          "type": "string",
          "description": "Date of the detection.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "Description of the detection."
        }
      },
      "required": [
        "id",
        "districtId",
        "crimeType",
        "date",
        "description"
      ]
    },
    "FileUpload": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "FileUpload",
      "type": "object",
      "description": "Represents a file upload record, tracking uploaded data files.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the FileUpload entity."
        },
        "filename": {
          "type": "string",
          "description": "Name of the uploaded file."
        },
        "uploadDate": {
          "type": "string",
          "description": "Date and time of the file upload.",
          "format": "date-time"
        },
        "fileType": {
          "type": "string",
          "description": "Type of file uploaded (e.g., CSV, Excel, PDF)."
        },
        "status": {
          "type": "string",
          "description": "Status of the file processing (e.g., uploaded, processing, completed, failed)."
        }
      },
      "required": [
        "id",
        "filename",
        "uploadDate",
        "fileType",
        "status"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/districts/{districtId}",
        "definition": {
          "entityName": "District",
          "schema": {
            "$ref": "#/backend/entities/District"
          },
          "description": "Stores police district information. Unique ID is the document ID. No denormalized fields are necessary as security is based on admin privileges.",
          "params": [
            {
              "name": "districtId",
              "description": "Unique identifier for the police district."
            }
          ]
        }
      },
      {
        "path": "/districts/{districtId}/records/{recordId}",
        "definition": {
          "entityName": "Record",
          "schema": {
            "$ref": "#/backend/entities/Record"
          },
          "description": "Stores individual police records associated with a district. Includes 'districtId' for authorization independence. Unique ID is the document ID.",
          "params": [
            {
              "name": "districtId",
              "description": "Unique identifier for the police district."
            },
            {
              "name": "recordId",
              "description": "Unique identifier for the record."
            }
          ]
        }
      },
      {
        "path": "/specialDrives/{specialDriveId}",
        "definition": {
          "entityName": "SpecialDrive",
          "schema": {
            "$ref": "#/backend/entities/SpecialDrive"
          },
          "description": "Stores information about special police drives. Unique ID is the document ID. No denormalized fields are necessary as security is based on admin privileges.",
          "params": [
            {
              "name": "specialDriveId",
              "description": "Unique identifier for the special drive."
            }
          ]
        }
      },
      {
        "path": "/convictions/{convictionId}",
        "definition": {
          "entityName": "Conviction",
          "schema": {
            "$ref": "#/backend/entities/Conviction"
          },
          "description": "Stores conviction records. Includes 'districtId' for authorization independence. Unique ID is the document ID.",
          "params": [
            {
              "name": "convictionId",
              "description": "Unique identifier for the conviction record."
            }
          ]
        }
      },
      {
        "path": "/detections/{detectionId}",
        "definition": {
          "entityName": "Detection",
          "schema": {
            "$ref": "#/backend/entities/Detection"
          },
          "description": "Stores detection records (crime detections). Includes 'districtId' for authorization independence. Unique ID is the document ID.",
          "params": [
            {
              "name": "detectionId",
              "description": "Unique identifier for the detection record."
            }
          ]
        }
      },
      {
        "path": "/fileUploads/{fileUploadId}",
        "definition": {
          "entityName": "FileUpload",
          "schema": {
            "$ref": "#/backend/entities/FileUpload"
          },
          "description": "Stores records of file uploads. Unique ID is the document ID. No denormalized fields are necessary as security is based on admin privileges.",
          "params": [
            {
              "name": "fileUploadId",
              "description": "Unique identifier for the file upload."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the Smart Analytics Dashboard for Police Good Work Recognition, focusing on scalability, security, and ease of querying. To ensure Authorization Independence, the `districtId` is included in the `records`, `convictions`, and `detections` collections, avoiding the need for `get()` calls to the `districts` collection in security rules. This denormalization enables atomic operations and simplifies security rule management.\n\nPath-Based Ownership: The structure leverages path-based ownership for data related to specific entities, such as using `/districts/{districtId}/records/{recordId}` to manage records associated with districts. This structure ensures clear ownership and efficient querying.\n\nStructural Segregation: Data with different access needs are segregated into distinct collections. For instance, `districts`, `records`, `specialDrives`, `convictions`, `detections`, and `fileUploads` are stored in separate collections to simplify security rules. Since all listed collections are secured by admin privilege no denormalization is required.\n\nTo support the required QAPs (Rules are Not Filters), the structure avoids mixing data with different access needs in the same collection, enabling secure list operations. The use of dedicated collections and the inclusion of `districtId` in relevant entities facilitate secure filtering and data retrieval based on district-level access.\n\nInvariants: The structure supports the integrity of ownership by explicitly defining the relationship between districts and their related data (records, convictions, detections) using the `districtId` field. Timestamps, if needed, can be added to these entities to track creation and modification times, ensuring data consistency."
  }
}